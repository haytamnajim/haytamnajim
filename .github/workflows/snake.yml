name: Generate Snake Animation

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pillow imageio imageio-ffmpeg numpy

      - name: Generate frames
        # Adaptez la commande si vos scripts sont différents
        run: |
          mkdir -p output frames
          python scripts/generate_snake.py --out frames

      - name: Create animation (GIF or MP4)
        run: |
          # Exemple: création d'un GIF. Adaptez selon vos outils.
          python scripts/make_gif.py frames output/snake.gif || \
          ffmpeg -framerate 25 -i frames/frame_%04d.png -c:v libx264 -pix_fmt yuv420p output/snake.mp4

      - name: Upload animation artifact
        uses: actions/upload-artifact@v4
        with:
          name: snake-animation
          path: |
            output/snake.gif
            output/snake.mp4
